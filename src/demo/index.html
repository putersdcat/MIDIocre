<!DOCTYPE html>
<html lang="en" data-theme="hakerman">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIDIocre Player ‚Äî v3.3 WaReZ Edition</title>
    <link rel="stylesheet" href="demo.css">
</head>
<body>
    <div class="wrapper">
        <!-- v3.3 HEADER -->
        <div class="header">| P√ºtersDcat | FULLY CRACKED |</div>
        
        <!-- v3.3 GRAFFITI BOMB WITH ANIMATED FUSE SPARKS + THEME COLORS -->
        <svg id="bomb-svg" width="920" height="480" viewBox="0 0 920 480" xmlns="http://www.w3.org/2000/svg" class="bomb-svg">
            <defs>
                <!-- BRICK PATTERN -->
                <pattern id="brick" patternUnits="userSpaceOnUse" width="92" height="48">
                    <rect id="brick-bg" width="92" height="48" fill="#aa0000"/>
                    <rect id="brick-line1" width="92" height="8" fill="#660000"/>
                    <rect id="brick-line2" x="46" y="24" width="46" height="8" fill="#660000"/>
                    <line x1="0" y1="0" x2="92" y2="0" stroke="#440000" stroke-width="4"/>
                    <line x1="0" y1="24" x2="92" y2="24" stroke="#440000" stroke-width="4"/>
                    <line x1="46" y1="0" x2="46" y2="48" stroke="#440000" stroke-width="4"/>
                </pattern>

                <!-- GRAFFITI GRADIENT (will be updated live per theme) -->
                <linearGradient id="graffiti" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop id="g-stop1" offset="0%" stop-color="#ff88ff"/>
                    <stop id="g-stop2" offset="25%" stop-color="#00ffcc"/>
                    <stop id="g-stop3" offset="50%" stop-color="#4488ff"/>
                    <stop id="g-stop4" offset="75%" stop-color="#ff2288"/>
                    <stop id="g-stop5" offset="100%" stop-color="#aa00ff"/>
                </linearGradient>

                <filter id="neon" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur stdDeviation="6" result="glow1"/>
                    <feGaussianBlur stdDeviation="14" result="glow2"/>
                    <feMerge>
                        <feMergeNode in="glow2"/>
                        <feMergeNode in="glow1"/>
                        <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                </filter>
                <filter id="thick" x="-30%" y="-30%" width="160%" height="160%">
                    <feDropShadow dx="0" dy="0" stdDeviation="3" flood-color="#000000" flood-opacity="1"/>
                </filter>
            </defs>

            <!-- RED BRICK BAR -->
            <rect x="0" y="0" width="920" height="92" fill="url(#brick)"/>

            <!-- THICK BLACK OUTLINE -->
            <text x="460" y="278" font-family="Impact, Arial Black, sans-serif" font-size="218" font-weight="900" fill="#111111" stroke="#000000" stroke-width="42" stroke-linejoin="round" paint-order="stroke fill" text-anchor="middle" dominant-baseline="middle" filter="url(#thick)">MIDIocre</text>

            <!-- VIBRANT GRAFFITI FILL + NEON -->
            <text x="460" y="278" font-family="Impact, Arial Black, sans-serif" font-size="218" font-weight="900" fill="url(#graffiti)" stroke="#112233" stroke-width="14" stroke-linejoin="round" paint-order="stroke fill" text-anchor="middle" dominant-baseline="middle" filter="url(#neon)">MIDIocre</text>

            <!-- WHITE HIGHLIGHT / DRIP SHINE -->
            <text x="452" y="265" font-family="Impact, Arial Black, sans-serif" font-size="218" font-weight="900" fill="#ffffff" opacity="0.35" stroke="none" text-anchor="middle" dominant-baseline="middle">MIDIocre</text>

            <!-- YOUR SIGNATURE -->
            <text x="760" y="430" font-family="Courier New, monospace" font-size="42" fill="#ff4422" opacity="0.9" text-anchor="end">√Ç√é ≈†≈Å√òP ƒå≈ò√ä≈¥</text>

            <!-- TINY TAG -->
            <text x="160" y="430" font-family="Courier New, monospace" font-size="26" fill="#00ff88" opacity="0.8" text-anchor="start">MIDIocre Player</text>

            <!-- v3.3 ANIMATED FUSE + SPARKS -->
            <g id="fuse-group">
                <!-- Wick -->
                <path id="wick" d="M 110 68 Q 85 105 78 175 Q 82 210 95 235" fill="none" stroke="#331100" stroke-width="14" stroke-linecap="round"/>
                <!-- Burning tip flame -->
                <ellipse id="flame" cx="95" cy="235" rx="9" ry="18" fill="#ff8800" opacity="0.9"/>
                <!-- Sparks (3 flickering + moving) -->
                <circle id="spark1" class="spark" cx="92" cy="160" r="4.5" fill="#ffff00"/>
                <circle id="spark2" class="spark" cx="79" cy="185" r="3" fill="#ffcc00" style="animation-delay:0.18s"/>
                <circle id="spark3" class="spark" cx="99" cy="205" r="5" fill="#ffaa00" style="animation-delay:0.35s"/>
            </g>
        </svg>

        <!-- ORIGINAL APP CONTENT WRAPPED -->
        <div id="app">
            <header>
              <!-- <h1>üéµ MIDIocre Player</h1>
              <p class="tagline">Mediocre by name, excellent by implementation.</p> -->
              <div class="header-controls">
                <div class="theme-picker">
                  <button class="theme-btn" data-theme="midnight" title="Midnight">üåô</button>
                  <button class="theme-btn active" data-theme="synthwave" title="Synthwave">üåÜ</button>
                  <button class="theme-btn" data-theme="emerald" title="Emerald">üå≤</button>
                  <button class="theme-btn" data-theme="frost" title="Frost">‚ùÑÔ∏è</button>
                  <button class="theme-btn" data-theme="hakerman" title="Hakerman">üíÄ</button>
                </div>
              </div>
            </header>

            <section id="controls">
              <div class="control-row">
                <div class="dropdowns">
                  <label>SoundFont:
                    <div class="select-with-nav">
                      <select id="sf2-select"><option value="">Loading‚Ä¶</option></select>
                      <div class="nav-buttons">
                        <button id="sf2-prev" class="nav-btn" title="Previous SoundFont">‚ñ≤</button>
                        <button id="sf2-next" class="nav-btn" title="Next SoundFont">‚ñº</button>
                      </div>
                    </div>
                  </label>
                  <label>MIDI:
                    <select id="midi-select"><option value="">Loading‚Ä¶</option></select>
                  </label>
                  <label>Instrument:
                    <div class="select-with-nav">
                      <select id="instrument-select"><option value="-1">Auto (per-channel)</option></select>
                      <div class="nav-buttons">
                        <button id="instrument-prev" class="nav-btn" title="Previous Instrument">‚ñ≤</button>
                        <button id="instrument-next" class="nav-btn" title="Next Instrument">‚ñº</button>
                      </div>
                    </div>
                  </label>
                </div>
              </div>

              <div class="control-row transport">
                <button id="btn-prev" class="transport-sm" title="Restart / Previous track">‚èÆ</button>
                <button id="btn-playpause" title="Play">‚ñ∂</button>
                <button id="btn-stop" title="Stop" disabled>‚èπ</button>
                <button id="btn-next" class="transport-sm" title="Next track">‚è≠</button>
                <label class="loop-toggle">
                  <input type="checkbox" id="chk-loop"> Loop
                </label>
              </div>

              <div class="control-row">
                <label class="slider-label">Tempo:
                  <input type="range" id="tempo-slider" min="10" max="300" value="100" step="1">
                  <span id="tempo-value">100%</span>
                </label>
                <label class="slider-label">Volume:
                  <input type="range" id="volume-slider" min="0" max="100" value="80" step="1">
                  <span id="volume-value">80%</span>
                </label>
              </div>
            </section>

            <section id="progress-section">
              <div class="viz-toolbar">
                <button class="viz-toggle active" data-viz="piano" title="Piano keys">üéπ</button>
                <button class="viz-toggle" data-viz="waterfall" title="Note stream">üåä</button>
                <button class="viz-toggle" data-viz="waveform" title="Waveform">„Ä∞Ô∏è</button>
              </div>
              <div class="viz-container">
                <canvas id="piano-canvas" width="800" height="80"></canvas>
                <canvas id="waterfall-canvas" width="800" height="200" style="display:none"></canvas>
                <canvas id="waveform-canvas" width="800" height="120" style="display:none"></canvas>
              </div>
              <div id="time-display">
                <span id="current-time">0:00</span> / <span id="total-time">0:00</span>
                <span id="voice-count"></span>
              </div>
            </section>

            <section id="status">
              <div id="status-text">Ready. Select a SoundFont and MIDI file to begin.</div>
            </section>

            <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SoundFont Builder ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
            <section id="sf2-builder">
              <div class="builder-header" id="builder-toggle">
                <h2>üîß SoundFont Builder</h2>
                <span class="builder-arrow">‚ñ∏</span>
              </div>
              <div class="builder-body" id="builder-body">

                <div class="builder-row">
                  <div class="builder-sources" id="builder-sources">
                    <h3>Available SoundFonts</h3>
                    <div class="builder-hint">Loading catalog‚Ä¶</div>
                    <div id="sf2-catalog-list" class="catalog-list"></div>
                  </div>
                  <div class="builder-selection" id="builder-selection">
                    <h3>Selected Presets <span id="selection-count">(0)</span></h3>
                    <div id="selection-list" class="selection-list">
                      <div class="builder-hint">Select presets from the left to add them here.</div>
                    </div>
                    <button id="btn-clear-selection" class="builder-btn btn-secondary" disabled>Clear All</button>
                  </div>
                </div>

                <div class="builder-form">
                  <h3>Output Settings</h3>
                  <div class="builder-form-row">
                    <label>SoundFont Name:
                      <input type="text" id="sf2-build-name" placeholder="My Custom SoundFont" maxlength="64">
                    </label>
                    <label>Filename:
                      <input type="text" id="sf2-build-filename" placeholder="MyCustom.sf2" maxlength="64">
                    </label>
                  </div>
                  <div class="builder-form-row">
                    <label>Engineer:
                      <input type="text" id="sf2-build-engineer" placeholder="(optional)" maxlength="64">
                    </label>
                    <label>Copyright:
                      <input type="text" id="sf2-build-copyright" placeholder="(optional)" maxlength="64">
                    </label>
                  </div>
                  <div class="builder-form-row">
                    <label class="full-width">Comments:
                      <input type="text" id="sf2-build-comments" placeholder="(optional)" maxlength="128">
                    </label>
                  </div>
                  <div class="builder-actions">
                    <label class="overwrite-toggle">
                      <input type="checkbox" id="sf2-build-overwrite"> Overwrite if exists
                    </label>
                    <button id="btn-build-sf2" class="builder-btn btn-primary" disabled>üî® Build SoundFont</button>
                  </div>
                  <div id="build-result" class="build-result"></div>
                </div>

              </div>
            </section>
        </div>

        <!-- FOOTER -->
        <div class="footer">Mediocre by name, excellent by implementation. //PDC|Cld46Op|RaptrMin|GrokC1|Grok\\</div>
        
        <div class="scanlines"></div>
        <div class="crt"></div>
    </div>

    <script>
        // === v3.3 THEME SWITCH + BOMB COLOR UPDATER ===
        const themeBombColors = {
            midnight: {
                brick: '#aa0000', brickDark: '#660000', brickLine: '#440000',
                graffiti: ['#ff88ff', '#ff44cc', '#aa00ff', '#ff2288', '#8800cc'],
                highlight: '#ffffff'
            },
            synthwave: {
                brick: '#cc0044', brickDark: '#770022', brickLine: '#550011',
                graffiti: ['#ff00ff', '#00ffff', '#ff44ff', '#00ffcc', '#ff88ff'],
                highlight: '#ffffff'
            },
            emerald: {
                brick: '#008822', brickDark: '#004411', brickLine: '#002200',
                graffiti: ['#00ff88', '#00cc66', '#44ffaa', '#00ff44', '#88ffcc'],
                highlight: '#ffffff'
            },
            frost: {
                brick: '#4477aa', brickDark: '#223355', brickLine: '#112244',
                graffiti: ['#88ddff', '#44aaff', '#77ccff', '#aaddff', '#ccffff'],
                highlight: '#ffffff'
            },
            hakerman: {
                brick: '#114411', brickDark: '#002200', brickLine: '#001100',
                graffiti: ['#00ff44', '#33ff88', '#66ffaa', '#99ffcc', '#ccffdd'],
                highlight: '#ffffff'
            }
        };

        function updateBombColors(theme) {
            const colors = themeBombColors[theme] || themeBombColors.hakerman;
            
            // Brick pattern
            document.getElementById('brick-bg').setAttribute('fill', colors.brick);
            document.getElementById('brick-line1').setAttribute('fill', colors.brickDark);
            document.getElementById('brick-line2').setAttribute('fill', colors.brickDark);
            
            // Graffiti gradient
            const stops = [
                document.getElementById('g-stop1'),
                document.getElementById('g-stop2'),
                document.getElementById('g-stop3'),
                document.getElementById('g-stop4'),
                document.getElementById('g-stop5')
            ];
            colors.graffiti.forEach((col, i) => {
                if (stops[i]) stops[i].setAttribute('stop-color', col);
            });
        }

        // Theme buttons
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const theme = btn.dataset.theme;
                document.documentElement.setAttribute('data-theme', theme);
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                updateBombColors(theme);
                
                // tiny header glitch flash
                const header = document.querySelector('.header');
                header.style.transition = 'none';
                header.style.transform = 'translateX(3px)';
                setTimeout(() => { header.style.transition = 'transform 80ms'; header.style.transform = 'translateX(-3px)'; }, 10);
                setTimeout(() => { header.style.transform = 'translateX(0)'; }, 180);
            });
        });

        // Play/Pause toggle (visual only)
        const playBtn = document.getElementById('play-pause-btn');
        const led = document.getElementById('play-led');
        if (playBtn && led) {
            let isPlaying = false;
            playBtn.addEventListener('click', () => {
                isPlaying = !isPlaying;
                playBtn.textContent = isPlaying ? '‚ùö‚ùö' : '‚ñ∂';
                led.style.background = isPlaying ? '#33ff33' : '#111';
                led.style.boxShadow = isPlaying ? '0 0 15px #33ff33' : 'none';
            });
        }

        // v3.3 199X BEEP + initial bomb colors
        setTimeout(() => {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const o = ctx.createOscillator();
            const g = ctx.createGain();
            o.type = 'square';
            o.frequency.setValueAtTime(220, ctx.currentTime);
            g.gain.value = 0.12;
            o.connect(g); g.connect(ctx.destination);
            o.start();
            setTimeout(() => o.stop(), 120);
            
            // init bomb colors
            updateBombColors(document.documentElement.getAttribute('data-theme'));
        }, 420);
    </script>

    <script>
        (function() {
            // Development server serves the compiled bundle as /dist/demo.js
            // Production (built for Pages) serves demo.js next to index.html (./demo.js)
            const isDev = location.pathname.startsWith('/src/demo') || location.hostname === 'localhost';
            const scriptSrc = isDev ? '/dist/demo.js' : './demo.js';
            const s = document.createElement('script');
            s.src = scriptSrc;
            s.defer = true;
            document.head.appendChild(s);
        })();
    </script>
</body>
</html>
